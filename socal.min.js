var SoCal=function(){this.minDate,this.selectedDate,this.date=new Date,this.today=new Date(this.date.getFullYear(),this.date.getMonth(),this.date.getDate()),this.calendarLevel="day",this.currentDay,this.currentMonth,this.currentYear,this.currentWeekDay,this.daysInCurrentMonth,this.monthStartOffset,this.monthEndOffset,this.callbacks={},this.calendarCollapseEnabled=!1,this.calendarCollapsed=!1,this.showYearEnabled=!1,this.showDateRanges=!1,this.minDateEnabled=!1,this.dateRangeEnabled=!1,this.dateSelectEnabled=!1,this.calendarLevelsEnabled=!1,this.dateInputEnabled=!1,this.toggleSelect=!0,this.dateRangeEditPosition=null,this.inputValue={},this.dateRange={},this.dateRangesArray=[],this.calendarEl};SoCal.prototype.config={month_long:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],day_mini:["Su","M","Tu","W","Th","F","Sa"],daterange_positions:["start","end"],calendarLevels:["day","month","year"]},SoCal.prototype.util={checkMonth:function(t){return 12===t?0:-1===t?11:t},checkDateParams:function(t){var e=this,a="",n="",s="",i="",r="",d=this.today.valueOf()===t?"today":"",l=function(e,i){!a&&(a=e.start_date&&e.start_date.valueOf()<=t&&e.end_date&&e.end_date.valueOf()>=t?i:""),!n&&(n=e.start_date&&e.start_date.valueOf()===t?"start-cap ":""),!s&&(s=e.end_date&&e.end_date.valueOf()===t?"end-cap ":"")};return this.dateRangesArray.length&&this.dateRangesArray.forEach(function(t){l.call(e,t,e.dateRangesRestricted?"restricted ":"within-range ")}),(this.dateRange.start_date||this.dateRange.end_date)&&l.call(e,this.dateRange,"within-range "),!i&&(i=this.selectedDate&&this.selectedDate.valueOf()===t?" selected-day ":""),this.minDateEnabled&&!r&&(r=t<this.minDate.valueOf()?"disabled ":""),i+a+n+s+r+d},formatDate:function(t,e){var a={numeric:t.getFullYear()+"-"+(t.getMonth()+1<10?0:"")+(t.getMonth()+1)+"-"+(t.getDate()<10?0:"")+t.getDate(),semantic:this.config.month_long[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()};return a[e]},formatDateRanges:function(t){return"string"==typeof t.start_date&&(t.start_date=new Date(t.start_date.replace(/\-/g,"/"))),"string"==typeof t.end_date&&(t.end_date=new Date(t.end_date.replace(/\-/g,"/"))),t.start_date&&(t.start_display=this.util.formatDate.call(this,t.start_date,"semantic")),t.end_date&&(t.end_display=this.util.formatDate.call(this,t.end_date,"semantic")),t}},SoCal.prototype.enableCollapsed=function(t){return this.calendarCollapseEnabled=!0,this.calendarCollapsed=t?t:!1,this},SoCal.prototype.enableDateSelection=function(){return this.dateSelectEnabled=!0,this},SoCal.prototype.enableDateRanges=function(){return this.dateRangeEnabled=!0,this.dateSelectEnabled=!0,this},SoCal.prototype.enableMinDate=function(t){return this.minDateEnabled=!0,this.minDate=t?new Date(t.split("-")):this.today,this},SoCal.prototype.enableCalendarLevels=function(){return this.calendarLevelsEnabled=!0,this},SoCal.prototype.enableShowDateRanges=function(){return this.showDateRanges=!0,this},SoCal.prototype.enableDateInput=function(){return this.dateInputEnabled=!0,this},SoCal.prototype.enableDateSelectToggle=function(t){return this.toggleSelect=t,this},SoCal.prototype.showYear=function(){return this.showYearEnabled=!0,this},SoCal.prototype.bindTo=function(t){return this.calendarElSelector=t,this.calendarEl=document.querySelector(t),this.calendarEl.classList.add("so-cal"),this.init(),this},SoCal.prototype.init=function(){this.getMonthParams(),this.renderCalendar(),this.addAllEvents()},SoCal.prototype.updateCalendar=function(t){this.date=new Date(this.currentYear,this.currentMonth,t),this.init()},SoCal.prototype.getMonthParams=function(){this.currentDay=this.date.getDate(),this.currentMonth=this.date.getMonth(),this.currentYear=this.date.getFullYear(),this.currentWeekday=this.date.getDay(),this.daysInCurrentMonth=new Date(this.currentYear,this.currentMonth+1,0).getDate(),this.monthStartOffset=new Date(this.currentYear,this.currentMonth,1).getDay(),this.monthEndOffset=42-(this.daysInCurrentMonth+this.monthStartOffset),this.currentMonthDisplay=this.config.month_long[this.currentMonth]},SoCal.prototype.renderCalendar=function(){this.calendarCollapsed?this.calendarEl.classList.add("collapsed"):this.calendarEl.classList.remove("collapsed");var t=document.createElement("div");t.classList.add("so-cal-container");var e="";this.dateInputEnabled&&(e+='<div class="so-cal-input"><input class="date-input" id="date-input" placeholder="Select Date" value="'+(this.inputValue.date_display?this.inputValue.date_display:"")+'"></div>'),this.dateRangeEnabled&&(e+='<div class="so-cal-daterange-header"><div class="so-cal-date '+("start"===this.dateRangeEditPosition?"active":"")+'" id="start-date"><div class="so-cal-daterange-subheader">Start Date</div>'+(this.dateRange.start_display?this.dateRange.start_display+'<span class="remove-date" id="remove-start-date">&times;</span>':"...")+'</div><div class="so-cal-date '+("end"===this.dateRangeEditPosition?"active":"")+'" id="end-date"><div class="so-cal-daterange-subheader">End Date</div>'+(this.dateRange.end_display?this.dateRange.end_display+'<span class="remove-date" id="remove-end-date">&times;</span>':"...")+"</div></div>"),"day"===this.calendarLevel&&(e+=this.renderDayCalendar()),"month"===this.calendarLevel&&(e+=this.renderMonthCalendar()),"year"===this.calendarLevel&&(e+=this.renderYearCalendar()),this.showDateRanges&&(this.dateRange.start||this.dateRangesArray.length)&&(e+=this.renderDateRanges()),this.calendarEl.innerHTML="",t.innerHTML=e,this.calendarEl.appendChild(t)},SoCal.prototype.renderDayCalendar=function(){var t=this.renderDays("short"),e=this.renderDaysBeforeMonth(),a=this.renderDaysCurrentMonth(),n=this.renderDaysAfterMonth(),s=this.calendarLevelsEnabled?"clickable":"",i='<div class="so-cal-header no-select"><div id="so-cal-previous" class="so-cal-changer"><span class="arrow-icon">‹</span></div><div class="so-cal-month-title '+s+'" id="month-header">'+this.currentMonthDisplay+(this.showYearEnabled?" - "+this.currentYear:"")+'</div><div id="so-cal-next" class="so-cal-changer"><span class="arrow-icon">›</span></div></div><div class="so-cal-days-header">'+t+'</div><div class="so-cal-date-grid">'+e+a+n+"</div>";return i},SoCal.prototype.renderMonthCalendar=function(){var t=this,e=this.calendarLevelsEnabled?"clickable":"",a="";this.config.month_short.forEach(function(e,n){var s=t.currentYear===t.date.getFullYear()&&t.currentMonth===n?"current-month ":"",i=t.minDateEnabled&&t.currentYear<=t.minDate.getFullYear()&&n<t.minDate.getMonth()||t.currentYear<t.date.getFullYear()?"disabled ":"",r=s+i;a+='<div class="so-cal-month '+r+'">'+e+"</div>"});var n='<div class="so-cal-header no-select"><div id="so-cal-previous" class="so-cal-changer"><span class="arrow-icon">‹</span></div><div class="so-cal-month-title month-view '+e+'" id="year-header">'+this.currentYear+'</div><div id="so-cal-next" class="so-cal-changer"><span class="arrow-icon">›</span></div></div><div class="so-cal-date-grid">'+a+"</div>";return n},SoCal.prototype.renderYearCalendar=function(){for(var t=this,e=this.calendarLevelsEnabled?"clickable":"",a="",n=t.currentYear-5;n<=t.currentYear+6;n++){var s=t.currentYear===n?"current-year ":"",i=t.minDateEnabled&&n<t.minDate.getFullYear()?"disabled ":"",r=s+i;a+='<div class="so-cal-year '+r+'">'+n+"</div>"}var d='<div class="so-cal-header no-select"><div class="so-cal-month-title year-view '+e+'" id="day-header">'+(this.currentYear-5)+"-"+(this.currentYear+6)+'</div></div><div class="so-cal-date-grid">'+a+"</div>";return d},SoCal.prototype.renderDays=function(t){for(var e=[],a="day_"+t,n=0;7>n;n++)e.push('<div class="so-cal-day-title"> '+this.config[a][n]+" </div>");return e.join("")},SoCal.prototype.renderDaysBeforeMonth=function(){for(var t=new Date(this.currentYear,this.currentMonth,0).getDate(),e=[],a=0;a<this.monthStartOffset;a++){var n=new Date(this.currentYear,this.currentMonth-1,t-a).valueOf(),s=this.util.checkDateParams.call(this,n);e.push('<div class="so-cal-day inactive '+s+'" data-type="previous" data-day="'+(t-a)+'"> '+(t-a)+" </div>")}return e.reverse(),e.join("")},SoCal.prototype.renderDaysCurrentMonth=function(){for(var t=[],e=0;e<this.daysInCurrentMonth;e++){var a=new Date(this.currentYear,this.currentMonth,e+1).valueOf(),n=this.util.checkDateParams.call(this,a);t.push('<div class="so-cal-day current-month '+n+'" data-type="current" data-day="'+(e+1)+'">'+(e+1)+"</div>")}return t.join("")},SoCal.prototype.renderDaysAfterMonth=function(){for(var t=[],e=0;e<this.monthEndOffset;e++){var a=new Date(this.currentYear,this.currentMonth+1,e+1).valueOf(),n=this.util.checkDateParams.call(this,a);t.push('<div class="so-cal-day inactive '+n+'" data-type="next" data-day="'+(e+1)+'">'+(e+1)+"</div>")}return t.join("")},SoCal.prototype.renderDateRanges=function(){var t="";return this.dateRangesArray.length?this.dateRangesArray.forEach(function(e,a){t+='<div class="so-cal-daterange">'+e.start_display+(e.end_display?" - "+e.end_display:"")+'<span class="so-cal-remove-daterange" data-index="'+a+'">&times;</span></div>'}):t+='<div class="so-cal-daterange">'+this.dateRange.start_display+(this.dateRange.end_display?" - "+this.dateRange.end_display:"")+'<span class="so-cal-remove-daterange" data-index="-1">&times;</span></div>',t},SoCal.prototype.addAllEvents=function(){"day"===this.calendarLevel&&this.addDayEvents(),"month"===this.calendarLevel&&this.addMonthEvents(),"year"===this.calendarLevel&&this.addYearEvents(),this.dateInputEnabled&&this.addDateInputEvents(),this.dateRangeEnabled&&this.addDateRangeEvents()},SoCal.prototype.addDayEvents=function(){var t=this,e=this.calendarEl.querySelector("#so-cal-previous"),a=this.calendarEl.querySelector("#so-cal-next"),n=this.calendarEl.querySelectorAll(".so-cal-day"),s=Array.prototype.slice.call(n),i=this.calendarEl.querySelector("#month-header");this.dateSelectEnabled&&s.forEach(function(e){e.addEventListener("click",t.selectDate.bind(t,e))}),i&&this.calendarLevelsEnabled&&i.addEventListener("click",this.setCalendarLevel.bind(this,"month",!0)),e&&e.addEventListener("click",this.setPreviousMonth.bind(this)),a&&a.addEventListener("click",this.setNextMonth.bind(this))},SoCal.prototype.addMonthEvents=function(){var t=this,e=this.calendarEl.querySelector("#so-cal-previous"),a=this.calendarEl.querySelector("#so-cal-next"),n=this.calendarEl.querySelectorAll(".so-cal-month"),s=Array.prototype.slice.call(n),i=this.calendarEl.querySelector("#year-header");s.forEach(function(e,a){e.addEventListener("click",t.selectMonth.bind(t,a))}),i.addEventListener("click",this.setCalendarLevel.bind(this,"year",!0)),e&&e.addEventListener("click",this.setPreviousYear.bind(this)),a&&a.addEventListener("click",this.setNextYear.bind(this))},SoCal.prototype.addYearEvents=function(){var t=this,e=this.calendarEl.querySelector("#day-header"),a=this.calendarEl.querySelectorAll(".so-cal-year"),n=Array.prototype.slice.call(a);e.addEventListener("click",this.setCalendarLevel.bind(this,"day",!0)),n.forEach(function(e){e.addEventListener("click",t.selectYear.bind(t,e.innerHTML))})},SoCal.prototype.addDateRangeEvents=function(){var t=this,e=this.calendarEl.querySelector("#start-date"),a=this.calendarEl.querySelector("#end-date"),n=this.calendarEl.querySelector("#remove-start-date"),s=this.calendarEl.querySelector("#remove-end-date"),i=this.calendarEl.querySelectorAll(".so-cal-remove-daterange"),r=Array.prototype.slice.call(i);a.addEventListener("click",this.setDateRangeEditPosition.bind(this,"end")),e.addEventListener("click",this.setDateRangeEditPosition.bind(this,"start")),s&&s.addEventListener("click",this.removeEndDate.bind(this)),n&&n.addEventListener("click",this.removeStartDate.bind(this)),r.length&&r.forEach(function(e,a){e.addEventListener("click",t.removeDaterange.bind(t,e))})},SoCal.prototype.addDateInputEvents=function(){var t=this.calendarEl.querySelector("#date-input");t.addEventListener("blur",this.checkDateInput.bind(this,t))},SoCal.prototype.checkDateInput=function(t){var e=new Date(t.value);if(("today"===t.value.toLowerCase()||"t"===t.value.toLowerCase())&&(e=this.today),e.valueOf()>0){var a=this.util.formatDate.call(this,e,"semantic");t.value=a,this.inputValue={date:e,date_display:a},this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear(),this.setActiveDate(e)}else this.inputValue={},t.value="",this.updateCalendar(1)},SoCal.prototype.onDateChange=function(t){return this.callbacks.dateChange=t,this},SoCal.prototype.onDateRangeChange=function(t){return this.callbacks.dateRangeChange=t,this},SoCal.prototype.onDateRangeArrayChange=function(t){return this.callbacks.dateRangeArrayChange=t,this},SoCal.prototype.setCalendarLevel=function(t,e){return this.calendarLevel=this.config.calendarLevels.indexOf(t)>-1?t:"day",e&&this.updateCalendar(this.currentDay),this},SoCal.prototype.setPreviousMonth=function(){this.currentMonth=this.util.checkMonth(--this.currentMonth),11===this.currentMonth&&this.currentYear--,this.updateCalendar(1)},SoCal.prototype.setNextMonth=function(){this.currentMonth=this.util.checkMonth(++this.currentMonth),0===this.currentMonth&&this.currentYear++,this.updateCalendar(1)},SoCal.prototype.setPreviousYear=function(){this.currentYear--,this.updateCalendar(1)},SoCal.prototype.setNextYear=function(){this.currentYear++,this.updateCalendar(1)},SoCal.prototype.selectDate=function(t){if(!t.classList.contains("disabled")&&!t.classList.contains("restricted")){var e;"previous"===t.dataset.type&&this.setPreviousMonth(),"next"===t.dataset.type&&this.setNextMonth(),e=new Date(this.currentYear,this.currentMonth,t.dataset.day),this.setActiveDate(e)}},SoCal.prototype.setActiveDate=function(t){this.selectedDate&&this.selectedDate.valueOf()===t.valueOf()&&this.toggleSelect?this.clearSelectedDate():this.selectedDate=t,this.enableDateInput&&(this.inputValue={date:t,date_display:this.util.formatDate.call(this,t,"semantic")}),this.dateRangeEnabled&&this.addToDateRange(t),this.updateCalendar(t.getDate()),this.callbacks.dateChange&&this.callbacks.dateChange.call(this,this.selectedDate)},SoCal.prototype.selectMonth=function(t){this.currentMonth=t,this.calendarLevel="day",this.updateCalendar(this.currentDay)},SoCal.prototype.selectYear=function(t){this.currentYear=t,this.calendarLevel="day",this.updateCalendar(this.currentDay)},SoCal.prototype.addToDateRange=function(t){var e=this.config.daterange_positions;if("start"===this.dateRangeEditPosition||!this.dateRange.start_date&&!this.dateRangeEditPosition)return this.dateRange.start_date=t,this.dateRange.start_display=this.util.formatDate.call(this,t,"semantic"),this.dateRangeEditPosition=null,this.dateRange.end_date&&this.dateRange.end_date.valueOf()<=t.valueOf()&&(this.dateRange.end_date=null,this.dateRange.end_display=null),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange),this;if("end"===this.dateRangeEditPosition)return this.dateRange.end_date=t,this.dateRange.end_display=this.util.formatDate.call(this,t,"semantic"),this.dateRangeEditPosition=null,this.dateRange.start_date&&this.dateRange.start_date.valueOf()>=t.valueOf()&&(delete this.dateRange.start_date,delete this.dateRange.start_display),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange),this;var a=t.valueOf()>this.dateRange.start_date.valueOf()|0;0===a&&(this.dateRange.end_date=this.dateRange.start_date,this.dateRange.end_display=this.dateRange.start_display),this.dateRange[e[a]+"_date"]=t,this.dateRange[e[a]+"_display"]=this.util.formatDate.call(this,t,"semantic"),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange)},SoCal.prototype.setDateRange=function(t){return this.dateRange=this.util.formatDateRanges.call(this,t),this},SoCal.prototype.setDateRanges=function(t,e){var a=this;return e&&(this.dateRangesRestricted=!0),t instanceof Array?(this.dateRangesArray=t.map(function(t){return a.util.formatDateRanges.call(a,t)}),this.callbacks.dateRangeArrayChange&&this.callbacks.dateRangeArrayChange.call(this,this.dateRangesArray)):(this.dateRange=a.util.formatDateRanges.call(a,t),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange)),this},SoCal.prototype.setDateRangeEditPosition=function(t){var e=this.calendarEl.querySelector(".so-cal-date.active");return e&&e.classList.remove("active"),this.dateRangeEditPosition===t?void(this.dateRangeEditPosition=null):(event.currentTarget.classList.add("active"),this.dateRangeEditPosition=t,this)},SoCal.prototype.toggleCollapsed=function(){this.calendarCollapseEnabled&&(this.calendarEl.classList.contains("collapsed")?(this.calendarEl.classList.remove("collapsed"),this.calendarCollapsed=!1):(this.calendarEl.classList.add("collapsed"),this.calendarCollapsed=!0))},SoCal.prototype.removeStartDate=function(t){delete this.dateRange.start_date,delete this.dateRange.start_display,this.clearSelectedDate(),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange),this.updateCalendar(this.currentDay)},SoCal.prototype.removeEndDate=function(t){delete this.dateRange.end_date,delete this.dateRange.end_display,this.clearSelectedDate(),this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange),this.updateCalendar(this.currentDay)},SoCal.prototype.clearSelectedDate=function(){this.dateRangeEditPosition=null,this.selectedDate=void 0,this.dateInputEnabled&&(this.inputValue={})},SoCal.prototype.removeDaterange=function(t){t&&t.dataset.index>-1?(this.dateRangesArray.splice(t.dataset.index,1),this.callbacks.dateRangeArrayChange&&this.callbacks.dateRangeArrayChange.call(this,this.dateRangeArray,this.dateRange)):(this.dateRange={},this.selectedDate=null,this.callbacks.dateRangeChange&&this.callbacks.dateRangeChange.call(this,this.dateRange)),this.clearSelectedDate(),this.init()};